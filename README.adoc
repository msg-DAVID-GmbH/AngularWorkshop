= Angular Workshop
:toc:
:toclevels: 1
:sectnums:
:imagesdir: images

These are my notes and code snippets from the Udemy Workshop https://www.udemy.com/the-complete-guide-to-angular-2[The complete guide to Angular].

== Introduction
* Angular = framework for reactive single-page-applications
** single-page = one HTML-file that gets changed by JS
** reactive = not necessarily a server-call (and if, can be done in the background)
* version madness
** "Angular.js" = Angular 1 = first version of framework
** "Angular 2" = first major rewrite, also known as simply "Angular"
** "Angular 3" skipped for some reason
** "Angular 4" and "Angular 5" = latest versions
** however, only two major and potentially incompatible versions: Angular.js and "the rest" a.k.a. "Angular" because only Angular 2 had major changes

== Setup Option 1: Just Angular
* this option: only little Angular project for learning plain angular
* following steps are for Windows machines; Linux can slightly diver

=== Install NodeJS
* https://nodejs.org/en/
* ... because Angular CLI needs it ...
* manages packages and loads a local development server

=== Install Angular CLI
* builds new projects that can than be used
* less setup, less writing boiler plate, more coding business logic
* in Windows console:

    npm install -g @angular/cli

* npm = Node package manager, came with NodeJS
* package.json in NPM comparable to pom.xml in Maven
* -g = global install
* @angular/cli = package

=== Create new Angular Project
* create new folder and navigate to it in console
* creating new project (in Windows console):

    ng new my-first-app

* "ng" stands for Angular
* my-first-app is the name of the app
* overview of what will be created:
** folder e2e contains end-to-end testing
** folder src/app should be the only location changes should be applied to
** src/index.html = HTML file that is changed by the Java Script of the framework. The dynamic content is inserted here:

  <body>
    <app-root></app-root>
  </body>

** folder node_modules is https://stackoverflow.com/questions/34526844/what-is-node-modules-directory-in-angularjs[just for build tools] and contains for example downloaded content like Bootstrap. Hence this is excluded in the .gitignore. These files are not necessary for deployment on server, just for development. For deployment, the content is bundled into one single file by the CLI.
** README.md contains the most important commands
** other single files = configuration; no need to touch ... maybe later

=== Run project
* navigate in created folder and run (in Windows console)

    ng serve

* will build all source code and run a dev server (see output for address)
* should be kept running all the time because changes in files are automatically saved, compiled and the app refreshed in the browser (without the need to hit F5!)

== Setup Option 2: JHipster = Angular with Spring Boot Backend and Deployment in Pivotal Cloud Foundry
* this option: complete and deployable application with Angular UI
* http://www.jhipster.tech[JHipster] = Spring Boot + Angular Generator

=== Install Yarn
* https://yarnpkg.com/lang/en/docs/install/#windows[Yarn] = Dependency Manager
* "yarn global add generator-jhipster" in Terminal will install Yarn

=== Create Project Folder

    mkdir testfolder && cd testfolder

=== Generate Project
* in Terminal:

    jhipster

=== Running Project locally
* running "ng serve" (like in Setup Option 1) in this folder doesn't work :(
* instead:
** "mvnw" to start Maven build and run application OR
** "yarn start" to start webpack development server for monitoring and generating beans and so on. Also notices changes in files and deploys them automatically OR
** via IDE: Maven Projects -> Plugins -> spring-boot -> spring-boot:run or simply execute run config (gets created automatically). This is also what will be done after deployment, so this is most likely the best option.
*** *Attention*: The application tends to switch to the prod-profile after deployment! To prevent this, add the VM Option "-Dspring.profiles.active=dev" in the run config.

=== Deployment to Pivotal Cloud Foundry
* for example in free version of https://run.pivotal.io[Pivotal Web Services]
* in terminal; explicit command to deploy to Cloud Foundry (see http://www.jhipster.tech/cloudfoundry/[help])

    jhipster cloudfoundry

* this will execute "cf push", create a route to the app and bind services like the database
* *Attention*:
** When running the first time, this will ask to overwrite the pom.xml because during build, additional dependencies are inserted. Overwrite the file.
** However, the new pom.xml doesn't get loaded with the first deployment. Hence, it will fail.
** "Solution": Deploy a second time.
** After this first run, every deployment will work fine.

=== Generating Entities with JDL-Studio
* http://www.jhipster.tech/jdl/[JDL = JHipster Domain Language]
* https://start.jhipster.tech/jdl-studio/[JDL Studio] = Online Generator for JDL-files that can be imported into JHipster and entities are created

== Tooling
* IntelliJ IDEA supports Angular right from the start:

image::angularSupportInWebStorm.png[]

* Reference search also working:

image::referenceSearchInIDEA.png[]

* also, https://www.jetbrains.com/webstorm/[WebStorm] is a lightweight IntelliJ IDEA and is suited for web development right away. However, IntelliJ IDEA https://stackoverflow.com/questions/13827214/can-intellij-idea-encapsulate-all-of-the-functionality-of-webstorm-and-phpstorm/13829907#13829907[can be upgraded via plugins to offer nearly the same functionality.]

== TypeScript
* Angular uses TypeScript: files ending with "ts"
* superset of Java Script, which is a new statically, strongly-typed programming language on top of Java Script
* doesn't run in the browser, has to be compiled - that's what the CLI is for!
* type can either be stated explicitly:

    serverId:number = 10;

* type can also be omitted and chosen automatically:

    serverId = 10;

* with Ctrl + B, variables reveal their types:

image::typeCheckingWithCtrlB.png[]

== Bootstrap
* https://getbootstrap.com[Bootstrap] = toolkit for HTML, CSS and JS
* in the course, Bootstrap 3 is used. Hence use

[source]
----
    npm install --save bootstrap@3
----

instead of

[source]
----
    npm install --save bootstrap
----

* run this in IntelliJ IDEA via build-in Terminal will download Bootstrap
* after downloading, it has to be imported:
** open .angular-cli.json
** add something to the array of styles:

[source,json]
----
    "styles": [
            "styles.css"
          ],
----
** add newly downloaded Bootstrap-style from directory node_modules:
----
    "styles": [
            "../node_modules/bootstrap/dist/css/bootstrap.css",
            "styles.css"
          ],
----

== Writing Components
* components = key feature of Angular
* reusable
* separation of concerns because every component has its own controller and therefore business logic
* what is a component and what not is often the question at hand
* after creating project with CLI, following files in src/app:
** *app.component.css*
*** CSS file for this specific component
** *app.component.html*
*** template of this component
*** what is written in this file is being copied to wherever the component is being used
** *app.component.spec.ts*
*** ?
** *app.component.ts*
*** definition of the component
*** defines the name (="selector") of the component ("app-root") with which it can be used in other HTML-files
** *app.module.ts*
*** ?
* naming convention in Angular: [name of component].component.[file type], for example "server.component.ts" is the type script file for the server component
* another aspect in Angular: "*Decorator*" = feature to enhance components with functionality, for example "@Component". Decorator needs information to know what to do with the annotated class, so a JSON object is provided:

  @Component({
    selector: 'app-root',
    templateUrl: './app.component.html',
    styleUrls: ['./app.component.css']
  })

=== Creating minimal Component
. create new directory in src/app, for example "server"
. create server.component.ts with a (unique!) selector and a reference to a template
. create template server.component.html
. register new component in app.module.ts in the declarations-array (there are other ways to make the new component known to the app, but that's the right way)
. use new component in app.component.html - NOT in the index.html because of best practice

=== Creating a Component via CLI
* open a *new* terminal window beside the one running _ng serve_
* the following will create a new component named "servers"

    ng generate component servers

* will create a new folder in _src/app_ and add an entry in app.module.ts, registering the new component

== Databinding
* = Communication between TypeScript-Code (which is business logic) and the HTML-Template
* Output Data from TypeScript to HTML-Template:
** String Interpolation ( _{{data}}_ )
** Property Binding ( _[property]="data"_ )
* React to to events
** Event Binding ( _(event)="expression"_ )
*** for example: <input type="text" class="form-control" (input)="onUpdateServerName($event)">
*** "$event" is the object automatically created with every event
* combination of both: Two-way-Binding ( _[(ngModel)]="data"_ )

